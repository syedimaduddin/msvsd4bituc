## Index

## OpenFASoC Flow
For OpenFASoC flow go to openfasoc install directory ```~/openfasoc/openfasoc/generators ``` create a folder ```msvsd4bituc```.
<img src="./Images/msvsd4bituc_folder.png">


Inside the ```msvsd4bituc``` there are many files and folders.
<img src="./Images/folders_inside_msvsd4bituc.png">

Top level Makefile 

```bash
# ==============================================================================
# Run msvsd4bituc design
# ==============================================================================

sky130hd_msvsd4bituc_verilog:
	python3 tools/msvsd4bituc-gen.py --specfile test.json --outputDir ./work --platform sky130hd --mode verilog

sky130hd_msvsd4bituc:
	python3 tools/msvsd4bituc-gen.py --specfile test.json --outputDir ./work --platform sky130hd --mode macro
	
sky130hd_msvsd4bituc_full:
	# add --pex to also run pex simulations
	python3 tools/msvsd4bituc-gen.py --specfile test.json --outputDir ./work --platform sky130hd --mode full --prepex

clean:
	rm -f search_result.csv
	rm -rf work
	rm -rf tools/*.pyc tools/__pycache__/
	cd flow && make clean_all
	cd simulations && rm -rf run

banner:
	@@echo "=============================================================="
	@@echo "   ___  _____ ______ _   _ _____  _     ____   ___   ____"
	@@echo "  / _ \|  _  \| ____| \ | |  ___|/ \   / ___| / _ \ / ___|"
	@@echo " | | | | |_) ||  _| |  \| | |_  / _ \  \___ \| | | | |    "
	@@echo " | |_| |  __/ | |___| |\  |  _|/ ___ \  ___) | |_| | |___ "
	@@echo "  \___/|_|    |_____|_| \_|_| /_/   \_\|____/ \___/ \____|"
	@@echo ""
	@@echo "==============================================================="
```

Go to ```/src/``` and place your dummy verilog code.
<img src="./Images/src_folder.png">

content of the ```/tools/``` Directory
<img src="./Images/tools_folder.png">

### Verilog Genertion
For our Simple design Verilog generation is just copying the verilog file 

```python
print("#----------------------------------------------------------------------")
print("# Verilog Generation")
print("#----------------------------------------------------------------------")

if args.platform == "sky130hd":
    aux1 = "ring_oscillator"
    aux2 = "adc_1bit"
elif args.platform == "sky130hs":
    aux1 = "ring_oscillator_hs"
    aux2 = "adc_1bit_hs"

with open(srcDir + "/msvsd4bituc.v", "r") as file:
    filedata = file.read()
if args.mode == "verilog":
    with open(flowDir+ "design/src/msvsd4bituc/msvsd4bituc.v", "w") as file:
        file.write(filedata)

with open(srcDir + "/ring_oscillator.v", "r") as file:
    filedata = file.read()
if args.mode == "verilog":
    with open(flowDir+ "design/src/msvsd4bituc/ring_oscillator.v", "w") as file:
        file.write(filedata)

with open(srcDir + "/adc_1bit.v", "r") as file:
    filedata = file.read()
if args.mode == "verilog":
    with open(flowDir+ "design/src/msvsd4bituc/adc_1bit.v", "w") as file:
        file.write(filedata)
 
print("# msvsd4bituc - Behavioural Verilog Generated")
print("#----------------------------------------------------------------------")
print("# Verilog Generated")
print("#----------------------------------------------------------------------")
print()
if args.mode == "verilog":
    print("Exiting tool....")
    exit()
```

To view the complete ```msvsd4bituc-gen.py``` file, Click HereðŸ‘‡
<details><summary>Netlist</summary>

```python

```
</details>


### Synthesized Verilog Code
To create synthesized verilog run the following command in terminal inside ``` /generators/msvsd4bituc/ ``` folder.
```
make sky130hd_msvsd4bituc_verilog
```
<img src="./Images/verilog_generation.png">

openfasoc generates synthesized Verilog code for openroad flow

```verilog
/* Generated by Yosys 0.26+39 (git sha1 f0116330b, clang 10.0.0-4ubuntu1 -fPIC -Os) */

module msvsd4bituc(vdd, vss, inn, out);
  input inn;
  wire inn;
  output out;
  wire out;
  wire ring_adc;
  input vdd;
  wire vdd;
  input vss;
  wire vss;
  adc_1bit adc (
    .inn(inn),
    .inp(ring_adc),
    .out(out),
    .vdd(vdd),
    .vss(vss)
  );
  ring_oscillator ring_osc (
    .inp(ring_adc),
    .vdd(vdd),
    .vss(vss)
  );
endmodule
```

### Config.mk file
To view the config.mk file inside folder ``` /msvsd4bituc/flow/design/sky130hd/msvsd4bituc/ ```. Click HereðŸ‘‡
<details><summary>Netlist</summary>

``` bash
export DESIGN_NICKNAME = msvsd4bituc
export DESIGN_NAME = msvsd4bituc
export PLATFORM    = sky130hd

export VERILOG_FILES 		= $(sort $(wildcard ./design/src/$(DESIGN_NICKNAME)/*.v)) 
export SDC_FILE    		= ./design/$(PLATFORM)/$(DESIGN_NICKNAME)/constraint.sdc

export DIE_AREA   	 	= 0 0 300 300
export CORE_AREA   		= 15 15 250 250

# area of the smaller voltage domain
export VD1_AREA                 = 50 50 100 150

# power delivery network config file
export PDN_TCL 			= ../blocks/$(PLATFORM)/pdn.tcl

export ADDITIONAL_LEFS  	= ../blocks/$(PLATFORM)/lef/ring_oscillator.lef \
                        	  ../blocks/$(PLATFORM)/lef/adc_1bit.lef
                        	  
export ADDITIONAL_GDS_FILES 	= ../blocks/$(PLATFORM)/gds/ring_oscillator.gds \
			      	  ../blocks/$(PLATFORM)/gds/adc_1bit.gds
			      	  
# informs what cells should be placed in the smaller voltage domain
export DOMAIN_INSTS_LIST 	= ../blocks/$(PLATFORM)/msvsd4bituc_domain_insts.txt

# configuration for placement

# don't run global place w/o IOs
export HAS_IO_CONSTRAINTS = 1

# don't run non-random IO placement (step 3_2)
export PLACE_PINS_ARGS = -random
export GPL_ROUTABILITY_DRIVEN = 1

# DPO optimization currently fails on the tempsense
export ENABLE_DPO = 0

# configuration for routing
export PRE_GLOBAL_ROUTE = $(SCRIPTS_DIR)/openfasoc/pre_global_route.tcl

# informs any short circuits that should be forced during routing
export CUSTOM_CONNECTION 	= ../blocks/$(PLATFORM)/msvsd4bituc_custom_net.txt

# indicates with how many connections the VIN route from the HEADER cells connects to the VIN power ring
export VIN_ROUTE_CONNECTION_POINTS = 2
```
</details>

<!--
### Run The Flow 
```
 make sky130hd_msvsd4bituc
```
#### Run Synthesis and APR

![image](https://user-images.githubusercontent.com/83899035/225961844-f67544af-1b10-456d-a14c-07ff49d36957.png)

#### Floorplan
![image](https://user-images.githubusercontent.com/83899035/225962407-a77d721a-4df0-4891-9803-2d1e7a66a5ad.png)

Design area 436 u^2 1% utilization.

![image](https://user-images.githubusercontent.com/83899035/225962694-25af6d95-3d95-462f-aa65-5aba3b21f738.png)

#### Global Place 
Design area 2347 u^2 4% utilization.

![image](https://user-images.githubusercontent.com/83899035/225963464-4c2af781-d7a0-4e10-aa53-5e581699afde.png)

![image](https://user-images.githubusercontent.com/83899035/225964970-1c636cf9-00d8-4955-9c65-be4b5c5ee97c.png)


![image](https://user-images.githubusercontent.com/83899035/225969781-23c8405f-b69e-4b3d-8185-8bcbcafb16c0.png)

|ADC|RING_OSCILLATOR|
|-|-|
|![image](https://user-images.githubusercontent.com/83899035/225976915-8f87c496-0d49-49c7-a8db-3e55f9523844.png)| ![image](https://user-images.githubusercontent.com/83899035/225977082-3a924e0c-48ed-40ef-bfc3-4f96336208a0.png)|

### Global Route
![image](https://user-images.githubusercontent.com/83899035/225983889-60a150f9-ace6-4f68-8f2a-c222e6438502.png)

![image](https://user-images.githubusercontent.com/83899035/225985261-5bdc8186-c440-44fc-a838-d0e604a653bb.png)


![image](https://user-images.githubusercontent.com/83899035/225965920-d89b127b-0f2e-4ed0-ab81-2a4a32489004.png)





### Final layout 
![image](https://user-images.githubusercontent.com/83899035/225990221-50b684f7-0638-4aba-b59f-d8d36f357480.png)

### Connection
![image](https://user-images.githubusercontent.com/83899035/225990502-cc7b4534-649d-4263-b4c6-56a0d06c5678.png)


![image](https://user-images.githubusercontent.com/83899035/225992309-945719f4-745d-40f3-b44d-946fab25266d.png)


### Final Files

![image](https://user-images.githubusercontent.com/83899035/225990746-a78ca4f8-471a-495d-a5b3-3b2269cbe50d.png)


### Error
![image](https://user-images.githubusercontent.com/83899035/225995506-24a8ecce-f392-4b53-a9e5-d392e58edfd4.png)


![image](https://user-images.githubusercontent.com/83899035/225995191-6a76fdc6-1056-4311-80f8-80871cca4a79.png)


## Only The GDS File part is left.
I face this problem because the hierarchy of lef and gds file(ALIGN FLOW)

## OpenROAD

![image](https://user-images.githubusercontent.com/83899035/225997365-e96bb189-baf7-46bf-8dee-ca7d16c06174.png)




<!-- 
|.gds|.lef|
|-|-|
|| |

For view The Full Netlist HereðŸ‘‡
<details><summary>Netlist</summary>

```

```
</details>
<br> -->
-->
